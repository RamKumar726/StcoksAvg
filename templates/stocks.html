{% extends "base.html" %}

{% block content %}
  <div class="row justify-content-center">
    <div class="col-md-10">
      <!-- Stock List Navbar Tabs -->
      <div class="mt-5">
        <ul class="nav nav-tabs" id="stockTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="fno-tab" data-bs-toggle="tab" data-bs-target="#fno-section" type="button" role="tab" aria-controls="fno-section" aria-selected="true">FNO Stocks</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="nifty50-tab" data-bs-toggle="tab" data-bs-target="#nifty50-section" type="button" role="tab" aria-controls="nifty50-section" aria-selected="false">NIFTY50</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="nifty-next-50-tab" data-bs-toggle="tab" data-bs-target="#nifty-next-50-section" type="button" role="tab" aria-controls="nifty-next-50-section" aria-selected="false">NIFTY Next 50</button>
          </li>
        </ul>

        <div class="tab-content" id="stockTabContent">
          <!-- FNO Stocks Section -->
          <div class="tab-pane fade show active" id="fno-section" role="tabpanel" aria-labelledby="fno-tab">
            <div class="card shadow-sm mt-3">
              <div class="card-body">
                <h5 class="card-title mb-3">FNO Stocks - Latest Prices</h5>
                <p class="text-muted mb-3">All FNO stocks with their latest prices (search to filter by first letter)</p>
                
                <div class="mb-3">
                  <input id="fnoSearchInput" type="text" class="form-control" placeholder="Filter FNO stocks (e.g., REL, ABB, TCS)..." autocomplete="off">
                </div>

                <!-- FNO Loading Spinner -->
                <div id="fnoLoadingSpinner" class="text-center" style="display: none;">
                  <div class="spinner-border spinner-border-sm text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                  <p class="mt-2 text-muted">Fetching prices...</p>
                </div>

                <!-- FNO Stocks Table -->
                <div id="fnoStocksContainer" style="display: none;">
                  <div class="table-responsive">
                    <table class="table table-striped table-hover" style="margin-bottom: 0;">
                      <thead style="background-color: #f8f9fa;">
                        <tr>
                          <th>Symbol</th>
                          <th>Latest Price (₹)</th>
                          <th>200-Week Avg (₹)</th>
                          <th>Status</th>
                        </tr>
                      </thead>
                      <tbody id="fnoStocksTable">
                      </tbody>
                    </table>
                  </div>
                </div>

                <!-- FNO No Results -->
                <div id="fnoNoResults" style="display: none; text-align: center; padding: 20px;">
                  <p class="text-muted">No stocks found matching your search.</p>
                </div>
              </div>
            </div>
          </div>

          <!-- NIFTY50 Stocks Section -->
          <div class="tab-pane fade" id="nifty50-section" role="tabpanel" aria-labelledby="nifty50-tab">
            <div class="card shadow-sm mt-3">
              <div class="card-body">
                <h5 class="card-title mb-3">NIFTY50 Stocks - Latest Prices</h5>
                <p class="text-muted mb-3">All NIFTY50 stocks with their latest prices (search to filter by first letter)</p>
                
                <div class="mb-3">
                  <input id="niftySearchInput" type="text" class="form-control" placeholder="Filter NIFTY50 stocks (e.g., REL, ABB, TCS)..." autocomplete="off">
                </div>

                <!-- NIFTY Loading Spinner -->
                <div id="niftyLoadingSpinner" class="text-center" style="display: none;">
                  <div class="spinner-border spinner-border-sm text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                  <p class="mt-2 text-muted">Fetching prices...</p>
                </div>

                <!-- NIFTY Stocks Table -->
                <div id="niftyStocksContainer" style="display: none;">
                  <div class="table-responsive">
                    <table class="table table-striped table-hover" style="margin-bottom: 0;">
                      <thead style="background-color: #f8f9fa;">
                        <tr>
                          <th>Symbol</th>
                          <th>Latest Price (₹)</th>
                          <th>200-Week Avg (₹)</th>
                          <th>Status</th>
                        </tr>
                      </thead>
                      <tbody id="niftyStocksTable">
                      </tbody>
                    </table>
                  </div>
                </div>

                <!-- NIFTY No Results -->
                <div id="niftyNoResults" style="display: none; text-align: center; padding: 20px;">
                  <p class="text-muted">No stocks found matching your search.</p>
                </div>
              </div>
            </div>
          </div>

          <!-- NIFTY Next 50 Stocks Section -->
          <div class="tab-pane fade" id="nifty-next-50-section" role="tabpanel" aria-labelledby="nifty-next-50-tab">
            <div class="card shadow-sm mt-3">
              <div class="card-body">
                <h5 class="card-title mb-3">NIFTY Next 50 Stocks - Latest Prices</h5>
                <p class="text-muted mb-3">All NIFTY Next 50 stocks with their latest prices (search to filter by first letter)</p>
                
                <div class="mb-3">
                  <input id="niftyNext50SearchInput" type="text" class="form-control" placeholder="Filter NIFTY Next 50 stocks (e.g., ABB, DLF, VEDL)..." autocomplete="off">
                </div>

                <!-- NIFTY Next 50 Loading Spinner -->
                <div id="niftyNext50LoadingSpinner" class="text-center" style="display: none;">
                  <div class="spinner-border spinner-border-sm text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                  <p class="mt-2 text-muted">Fetching prices...</p>
                </div>

                <!-- NIFTY Next 50 Stocks Table -->
                <div id="niftyNext50StocksContainer" style="display: none;">
                  <div class="table-responsive">
                    <table class="table table-striped table-hover" style="margin-bottom: 0;">
                      <thead style="background-color: #f8f9fa;">
                        <tr>
                          <th>Symbol</th>
                          <th>Latest Price (₹)</th>
                          <th>200-Week Avg (₹)</th>
                          <th>Status</th>
                        </tr>
                      </thead>
                      <tbody id="niftyNext50StocksTable">
                      </tbody>
                    </table>
                  </div>
                </div>

                <!-- NIFTY Next 50 No Results -->
                <div id="niftyNext50NoResults" style="display: none; text-align: center; padding: 20px;">
                  <p class="text-muted">No stocks found matching your search.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // FNO Stocks functionality
    const fnoSearchInput = document.getElementById('fnoSearchInput');
    const fnoLoadingSpinner = document.getElementById('fnoLoadingSpinner');
    const fnoStocksContainer = document.getElementById('fnoStocksContainer');
    const fnoStocksTable = document.getElementById('fnoStocksTable');
    const fnoNoResults = document.getElementById('fnoNoResults');
    let fnoSearchTimeout;
    let allFnoStocks = []; // Cache all stocks

    // Function to display FNO stocks
    async function loadFnoStocks(searchQuery = '') {
      fnoLoadingSpinner.style.display = 'block';
      fnoStocksContainer.style.display = 'none';
      fnoNoResults.style.display = 'none';

      try {
        const response = await fetch(`/api/fno-stocks?q=${encodeURIComponent(searchQuery)}`);

        if (!response.ok) {
          console.error('FNO search failed:', response.statusText);
          fnoLoadingSpinner.style.display = 'none';
          fnoNoResults.style.display = 'block';
          fnoStocksContainer.style.display = 'none';
          return;
        }

        const data = await response.json();
        const stocks = data.stocks || [];

        // Cache all stocks on first load
        if (searchQuery === '') {
          allFnoStocks = stocks;
        }

        fnoLoadingSpinner.style.display = 'none';

        if (stocks.length === 0) {
          fnoNoResults.style.display = 'block';
          fnoStocksContainer.style.display = 'none';
          return;
        }

        // Populate table
        fnoStocksTable.innerHTML = stocks.map(stock => {
          const priceText = stock.price ? `₹${stock.price.toFixed(2)}` : 'N/A';
          const hasAvg = (stock.avg_200w && !isNaN(stock.avg_200w));
          const avgRaw = hasAvg ? parseFloat(stock.avg_200w) : null;
          const avgText = hasAvg ? `₹${avgRaw.toFixed(2)}` : '—';
          let statusBadge = '';
          let avgStyle = 'color: #000;';
          let rowStyle = '';

          if (stock.status === 'success') {
            statusBadge = '<span class="badge bg-success">✓ Fetched</span>';
          } else if (stock.status === 'no_data') {
            statusBadge = '<span class="badge bg-warning">No Data</span>';
          } else {
            statusBadge = '<span class="badge bg-danger">Error</span>';
          }

          // Color entire row green when latest price is below 200-week avg
          if (stock.price && hasAvg) {
            try {
              if (parseFloat(stock.price) < avgRaw) {
                rowStyle = 'background-color: #d1e7dd;';
                avgStyle = 'color: #198754; font-weight: 600;';
              }
            } catch (e) {
              // ignore
            }
          }

          return `
            <tr class="${rowStyle ? 'highlight-row' : ''}">
              <td><strong>${stock.symbol}</strong></td>
              <td>${priceText}</td>
              <td style="${avgStyle}">${avgText}</td>
              <td>${statusBadge}</td>
            </tr>
          `;
        }).join('');

        fnoStocksContainer.style.display = 'block';
        fnoNoResults.style.display = 'none';
      } catch (error) {
        console.error('FNO search error:', error);
        fnoLoadingSpinner.style.display = 'none';
        fnoNoResults.style.display = 'block';
        fnoStocksContainer.style.display = 'none';
      }
    }

    // Load all FNO stocks on page load
    loadFnoStocks();

    // Search functionality
    fnoSearchInput.addEventListener('input', (e) => {
      const query = e.target.value.trim().toUpperCase();

      clearTimeout(fnoSearchTimeout);

      fnoSearchTimeout = setTimeout(() => {
        if (query === '') {
          // Show all stocks if search is empty
          loadFnoStocks();
        } else {
          // Filter from cached stocks
          const filtered = allFnoStocks.filter(stock => 
            stock.symbol.startsWith(query)
          );

          fnoLoadingSpinner.style.display = 'none';

          if (filtered.length === 0) {
            fnoNoResults.style.display = 'block';
            fnoStocksContainer.style.display = 'none';
            return;
          }

          // Populate table with filtered results
          fnoStocksTable.innerHTML = filtered.map(stock => {
            const priceText = stock.price ? `₹${stock.price.toFixed(2)}` : 'N/A';
            const hasAvg = (stock.avg_200w && !isNaN(stock.avg_200w));
            const avgRaw = hasAvg ? parseFloat(stock.avg_200w) : null;
            const avgText = hasAvg ? `₹${avgRaw.toFixed(2)}` : '—';
            let statusBadge = '';
            let avgStyle = 'color: #000;';
            let rowStyle = '';

            if (stock.status === 'success') {
              statusBadge = '<span class="badge bg-success">✓ Fetched</span>';
            } else if (stock.status === 'no_data') {
              statusBadge = '<span class="badge bg-warning">No Data</span>';
            } else {
              statusBadge = '<span class="badge bg-danger">Error</span>';
            }

            // Color entire row green when latest price is below 200-week avg
            if (stock.price && hasAvg) {
              try {
                if (parseFloat(stock.price) < avgRaw) {
                  rowStyle = 'background-color: #d1e7dd;';
                  avgStyle = 'color: #198754; font-weight: 600;';
                }
              } catch (e) {
                // ignore
              }
            }

            return `
              <tr class="${rowStyle ? 'highlight-row' : ''}">
                <td><strong>${stock.symbol}</strong></td>
                <td>${priceText}</td>
                <td style="${avgStyle}">${avgText}</td>
                <td>${statusBadge}</td>
              </tr>
            `;
          }).join('');

          fnoStocksContainer.style.display = 'block';
          fnoNoResults.style.display = 'none';
        }
      }, 300);
    });

    // NIFTY Stocks functionality
    const niftySearchInput = document.getElementById('niftySearchInput');
    const niftyLoadingSpinner = document.getElementById('niftyLoadingSpinner');
    const niftyStocksContainer = document.getElementById('niftyStocksContainer');
    const niftyStocksTable = document.getElementById('niftyStocksTable');
    const niftyNoResults = document.getElementById('niftyNoResults');
    let niftySearchTimeout;
    let allNiftyStocks = []; // Cache all stocks

    // Function to display NIFTY stocks
    async function loadNiftyStocks(searchQuery = '') {
      niftyLoadingSpinner.style.display = 'block';
      niftyStocksContainer.style.display = 'none';
      niftyNoResults.style.display = 'none';

      try {
        const response = await fetch(`/api/nifty-stocks?q=${encodeURIComponent(searchQuery)}`);

        if (!response.ok) {
          console.error('NIFTY search failed:', response.statusText);
          niftyLoadingSpinner.style.display = 'none';
          niftyNoResults.style.display = 'block';
          niftyStocksContainer.style.display = 'none';
          return;
        }

        const data = await response.json();
        const stocks = data.stocks || [];

        // Cache all stocks on first load
        if (searchQuery === '') {
          allNiftyStocks = stocks;
        }

        niftyLoadingSpinner.style.display = 'none';

        if (stocks.length === 0) {
          niftyNoResults.style.display = 'block';
          niftyStocksContainer.style.display = 'none';
          return;
        }

        // Populate table
        niftyStocksTable.innerHTML = stocks.map(stock => {
          const priceText = stock.price ? `₹${stock.price.toFixed(2)}` : 'N/A';
          const hasAvg = (stock.avg_200w && !isNaN(stock.avg_200w));
          const avgRaw = hasAvg ? parseFloat(stock.avg_200w) : null;
          const avgText = hasAvg ? `₹${avgRaw.toFixed(2)}` : '—';
          let statusBadge = '';
          let rowStyle = '';
          let avgStyle = 'color: #000;';

          if (stock.status === 'success') {
            statusBadge = '<span class="badge bg-success">✓ Fetched</span>';
          } else if (stock.status === 'no_data') {
            statusBadge = '<span class="badge bg-warning">No Data</span>';
          } else {
            statusBadge = '<span class="badge bg-danger">Error</span>';
          }

          // Highlight row green if price < 200-week avg
          if (stock.price && hasAvg) {
            try {
              if (parseFloat(stock.price) < avgRaw) {
                rowStyle = 'background-color: #d1e7dd;';
                avgStyle = 'color: #198754; font-weight: 600;';
              }
            } catch (e) {
              // ignore
            }
          }

          return `
            <tr class="${rowStyle ? 'highlight-row' : ''}">
              <td><strong>${stock.symbol}</strong></td>
              <td>${priceText}</td>
              <td style="${avgStyle}">${avgText}</td>
              <td>${statusBadge}</td>
            </tr>
          `;
        }).join('');

        niftyStocksContainer.style.display = 'block';
        niftyNoResults.style.display = 'none';
      } catch (error) {
        console.error('NIFTY search error:', error);
        niftyLoadingSpinner.style.display = 'none';
        niftyNoResults.style.display = 'block';
        niftyStocksContainer.style.display = 'none';
      }
    }

    // Load all NIFTY stocks on page load
    loadNiftyStocks();

    // Search functionality
    niftySearchInput.addEventListener('input', (e) => {
      const query = e.target.value.trim().toUpperCase();

      clearTimeout(niftySearchTimeout);

      niftySearchTimeout = setTimeout(() => {
        if (query === '') {
          // Show all stocks if search is empty
          loadNiftyStocks();
        } else {
          // Filter from cached stocks
          const filtered = allNiftyStocks.filter(stock => 
            stock.symbol.startsWith(query)
          );

          niftyLoadingSpinner.style.display = 'none';

          if (filtered.length === 0) {
            niftyNoResults.style.display = 'block';
            niftyStocksContainer.style.display = 'none';
            return;
          }

          // Populate table with filtered results
          niftyStocksTable.innerHTML = filtered.map(stock => {
            const priceText = stock.price ? `₹${stock.price.toFixed(2)}` : 'N/A';
            const hasAvg = (stock.avg_200w && !isNaN(stock.avg_200w));
            const avgRaw = hasAvg ? parseFloat(stock.avg_200w) : null;
            const avgText = hasAvg ? `₹${avgRaw.toFixed(2)}` : '—';
            let statusBadge = '';
            let rowStyle = '';
            let avgStyle = 'color: #000;';

            if (stock.status === 'success') {
              statusBadge = '<span class="badge bg-success">✓ Fetched</span>';
            } else if (stock.status === 'no_data') {
              statusBadge = '<span class="badge bg-warning">No Data</span>';
            } else {
              statusBadge = '<span class="badge bg-danger">Error</span>';
            }

            // Highlight row green if price < 200-week avg
            if (stock.price && hasAvg) {
              try {
                if (parseFloat(stock.price) < avgRaw) {
                  rowStyle = 'background-color: #d1e7dd;';
                  avgStyle = 'color: #198754; font-weight: 600;';
                }
              } catch (e) {
                // ignore
              }
            }

            return `
              <tr class="${rowStyle ? 'highlight-row' : ''}">
                <td><strong>${stock.symbol}</strong></td>
                <td>${priceText}</td>
                <td style="${avgStyle}">${avgText}</td>
                <td>${statusBadge}</td>
              </tr>
            `;
          }).join('');

          niftyStocksContainer.style.display = 'block';
          niftyNoResults.style.display = 'none';
        }
      }, 300);
    });

    // NIFTY Next 50 Stocks functionality
    const niftyNext50SearchInput = document.getElementById('niftyNext50SearchInput');
    const niftyNext50LoadingSpinner = document.getElementById('niftyNext50LoadingSpinner');
    const niftyNext50StocksContainer = document.getElementById('niftyNext50StocksContainer');
    const niftyNext50StocksTable = document.getElementById('niftyNext50StocksTable');
    const niftyNext50NoResults = document.getElementById('niftyNext50NoResults');
    let niftyNext50SearchTimeout;
    let allNiftyNext50Stocks = []; // Cache all stocks

    // Function to display NIFTY Next 50 stocks
    async function loadNiftyNext50Stocks(searchQuery = '') {
      niftyNext50LoadingSpinner.style.display = 'block';
      niftyNext50StocksContainer.style.display = 'none';
      niftyNext50NoResults.style.display = 'none';

      try {
        const response = await fetch(`/api/nifty-next-50-stocks?q=${encodeURIComponent(searchQuery)}`);

        if (!response.ok) {
          console.error('NIFTY Next 50 search failed:', response.statusText);
          niftyNext50LoadingSpinner.style.display = 'none';
          niftyNext50NoResults.style.display = 'block';
          niftyNext50StocksContainer.style.display = 'none';
          return;
        }

        const data = await response.json();
        const stocks = data.stocks || [];

        // Cache all stocks on first load
        if (searchQuery === '') {
          allNiftyNext50Stocks = stocks;
        }

        niftyNext50LoadingSpinner.style.display = 'none';

        if (stocks.length === 0) {
          niftyNext50NoResults.style.display = 'block';
          niftyNext50StocksContainer.style.display = 'none';
          return;
        }

        // Populate table
        niftyNext50StocksTable.innerHTML = stocks.map(stock => {
          const priceText = stock.price ? `₹${stock.price.toFixed(2)}` : 'N/A';
          const hasAvg = (stock.avg_200w && !isNaN(stock.avg_200w));
          const avgRaw = hasAvg ? parseFloat(stock.avg_200w) : null;
          const avgText = hasAvg ? `₹${avgRaw.toFixed(2)}` : '—';
          let statusBadge = '';
          let rowStyle = '';
          let avgStyle = 'color: #000;';

            if (stock.status === 'success') {
              statusBadge = '<span class="badge bg-success">✓ Fetched</span>';
            } else if (stock.status === 'no_data') {
              statusBadge = '<span class="badge bg-warning">No Data</span>';
            } else {
              statusBadge = '<span class="badge bg-danger">Error</span>';
            }

            // Highlight row green if price < 200-week avg
            if (stock.price && hasAvg) {
              try {
                if (parseFloat(stock.price) < avgRaw) {
                  rowStyle = 'background-color: #d1e7dd;';
                  avgStyle = 'color: #198754; font-weight: 600;';
                }
              } catch (e) {
                // ignore
              }
            }

            // Determine price color for the Status column
            let priceClass = 'text-muted';
            if (stock.price && hasAvg) {
              try {
                const p = parseFloat(stock.price);
                if (p < avgRaw) priceClass = 'text-success';
                else if (p > avgRaw) priceClass = 'text-danger';
              } catch (e) {}
            }

            return `
              <tr class="${rowStyle ? 'highlight-row' : ''}">
                <td><strong>${stock.symbol}</strong></td>
                <td>${priceText}</td>
                <td style="${avgStyle}">${avgText}</td>
                <td>${statusBadge} <span class="${priceClass}" style="margin-left:8px;font-weight:600">${priceText}</span></td>
              </tr>
            `;
        }).join('');

        niftyNext50StocksContainer.style.display = 'block';
        niftyNext50NoResults.style.display = 'none';
      } catch (error) {
        console.error('NIFTY Next 50 search error:', error);
        niftyNext50LoadingSpinner.style.display = 'none';
        niftyNext50NoResults.style.display = 'block';
        niftyNext50StocksContainer.style.display = 'none';
      }
    }

    // Load all NIFTY Next 50 stocks on page load
    loadNiftyNext50Stocks();

    // Search functionality
    niftyNext50SearchInput.addEventListener('input', (e) => {
      const query = e.target.value.trim().toUpperCase();

      clearTimeout(niftyNext50SearchTimeout);

      niftyNext50SearchTimeout = setTimeout(() => {
        if (query === '') {
          // Show all stocks if search is empty
          loadNiftyNext50Stocks();
        } else {
          // Filter from cached stocks
          const filtered = allNiftyNext50Stocks.filter(stock => 
            stock.symbol.startsWith(query)
          );

          niftyNext50LoadingSpinner.style.display = 'none';

          if (filtered.length === 0) {
            niftyNext50NoResults.style.display = 'block';
            niftyNext50StocksContainer.style.display = 'none';
            return;
          }

          // Populate table with filtered results
          niftyNext50StocksTable.innerHTML = filtered.map(stock => {
            const priceText = stock.price ? `₹${stock.price.toFixed(2)}` : 'N/A';
            const hasAvg = (stock.avg_200w && !isNaN(stock.avg_200w));
            const avgRaw = hasAvg ? parseFloat(stock.avg_200w) : null;
            const avgText = hasAvg ? `₹${avgRaw.toFixed(2)}` : '—';
            let statusBadge = '';
            let rowStyle = '';
            let avgStyle = 'color: #000;';

            if (stock.status === 'success') {
              statusBadge = '<span class="badge bg-success">✓ Fetched</span>';
            } else if (stock.status === 'no_data') {
              statusBadge = '<span class="badge bg-warning">No Data</span>';
            } else {
              statusBadge = '<span class="badge bg-danger">Error</span>';
            }

            // Highlight row green if price < 200-week avg
            if (stock.price && hasAvg) {
              try {
                if (parseFloat(stock.price) < avgRaw) {
                  rowStyle = 'background-color: #d1e7dd;';
                  avgStyle = 'color: #198754; font-weight: 600;';
                }
              } catch (e) {
                // ignore
              }
            }

            return `
              <tr class="${rowStyle ? 'highlight-row' : ''}">
                <td><strong>${stock.symbol}</strong></td>
                <td>${priceText}</td>
                <td style="${avgStyle}">${avgText}</td>
                <td>${statusBadge}</td>
              </tr>
            `;
          }).join('');

          niftyNext50StocksContainer.style.display = 'block';
          niftyNext50NoResults.style.display = 'none';
        }
      }, 300);
    });
  </script>
  <script>
    // Activate tab based on URL hash (e.g., /stocks#fno, /stocks#nifty50)
    function activateTabFromHash() {
      const hash = (location.hash || '').toLowerCase();
      const map = {
        '#fno': 'fno-tab',
        '#fno-section': 'fno-tab',
        '#nifty50': 'nifty50-tab',
        '#nifty50-section': 'nifty50-tab',
        '#nifty-next-50': 'nifty-next-50-tab',
        '#nifty-next-50-section': 'nifty-next-50-tab'
      };

      const tabId = map[hash] || null;
      if (tabId) {
        const el = document.getElementById(tabId);
        if (el && window.bootstrap && bootstrap.Tab) {
          const tab = new bootstrap.Tab(el);
          tab.show();
        }
      }
    }

    // Handle hash changes while on the page
    window.addEventListener('hashchange', activateTabFromHash);
    // Activate initially
    document.addEventListener('DOMContentLoaded', () => {
      activateTabFromHash();
    });
  </script>
{% endblock %}
